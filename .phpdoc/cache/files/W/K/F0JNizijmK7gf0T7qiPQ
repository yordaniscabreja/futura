1688216197
waR3U4bTeM%3Ad9ee60219d282eb56247c501038fcbb0-8dba084849a8a9dae5a33c8986c7c1fa
s:30428:"TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlIjoxNDp7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBkb2NCbG9jayI7TjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGhhc2giO3M6MzI6IjhkYmEwODQ4NDlhOGE5ZGFlNWEzM2M4OTg2YzdjMWZhIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWUiO3M6MTU6ImluZGV4LmJsYWRlLnBocCI7czozOToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBwYXRoIjtzOjU0OiJ2ZW5kb3IvZmlsYW1lbnQvdGFibGVzL3Jlc291cmNlcy92aWV3cy9pbmRleC5ibGFkZS5waHAiO3M6NDE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAc291cmNlIjtzOjIxODgzOiJAcGhwCiAgICB1c2UgRmlsYW1lbnRcVGFibGVzXEZpbHRlcnNcTGF5b3V0OwoKICAgICRhY3Rpb25zID0gJGdldEFjdGlvbnMoKTsKICAgICRjb2x1bW5zID0gJGdldENvbHVtbnMoKTsKICAgICRjb250ZW50ID0gJGdldENvbnRlbnQoKTsKICAgICRjb250ZW50Rm9vdGVyID0gJGdldENvbnRlbnRGb290ZXIoKTsKICAgICRoZWFkZXIgPSAkZ2V0SGVhZGVyKCk7CiAgICAkaGVhZGVyQWN0aW9ucyA9ICRnZXRIZWFkZXJBY3Rpb25zKCk7CiAgICAkaGVhZGluZyA9ICRnZXRIZWFkaW5nKCk7CiAgICAkaXNTZWFyY2hWaXNpYmxlID0gJGlzU2VhcmNoYWJsZSgpOwogICAgJGhhc0ZpbHRlcnMgPSAkaXNGaWx0ZXJhYmxlKCk7CiAgICAkaGFzRmlsdGVyc1BvcG92ZXIgPSAkaGFzRmlsdGVycyAmJiAoJGdldEZpbHRlcnNMYXlvdXQoKSA9PT0gTGF5b3V0OjpQb3BvdmVyKTsKICAgICRoYXNGaWx0ZXJzQWJvdmVDb250ZW50ID0gJGhhc0ZpbHRlcnMgJiYgKCRnZXRGaWx0ZXJzTGF5b3V0KCkgPT09IExheW91dDo6QWJvdmVDb250ZW50KTsKICAgICRpc0NvbHVtblRvZ2dsZUZvcm1WaXNpYmxlID0gJGhhc1RvZ2dsZWFibGVDb2x1bW5zKCk7CgogICAgJGNvbHVtbnNDb3VudCA9IGNvdW50KCRjb2x1bW5zKTsKICAgIGlmIChjb3VudCgkYWN0aW9ucykpICRjb2x1bW5zQ291bnQrKzsKICAgIGlmICgkaXNTZWxlY3Rpb25FbmFibGVkKCkpICRjb2x1bW5zQ291bnQrKzsKCiAgICAkZ2V0SGlkZGVuQ2xhc3NlcyA9IGZ1bmN0aW9uIChcRmlsYW1lbnRcVGFibGVzXENvbHVtbnNcQ29sdW1uICRjb2x1bW4pOiA/c3RyaW5nIHsKICAgICAgICBpZiAoJGJyZWFrcG9pbnQgPSAkY29sdW1uLT5nZXRIaWRkZW5Gcm9tKCkpIHsKICAgICAgICAgICAgcmV0dXJuIG1hdGNoICgkYnJlYWtwb2ludCkgewogICAgICAgICAgICAgICAgJ3NtJyA9PiAnc206aGlkZGVuJywKICAgICAgICAgICAgICAgICdtZCcgPT4gJ21kOmhpZGRlbicsCiAgICAgICAgICAgICAgICAnbGcnID0+ICdsZzpoaWRkZW4nLAogICAgICAgICAgICAgICAgJ3hsJyA9PiAneGw6aGlkZGVuJywKICAgICAgICAgICAgICAgICcyeGwnID0+ICcyeGw6aGlkZGVuJywKICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGlmICgkYnJlYWtwb2ludCA9ICRjb2x1bW4tPmdldFZpc2libGVGcm9tKCkpIHsKICAgICAgICAgICAgcmV0dXJuIG1hdGNoICgkYnJlYWtwb2ludCkgewogICAgICAgICAgICAgICAgJ3NtJyA9PiAnaGlkZGVuIHNtOnRhYmxlLWNlbGwnLAogICAgICAgICAgICAgICAgJ21kJyA9PiAnaGlkZGVuIG1kOnRhYmxlLWNlbGwnLAogICAgICAgICAgICAgICAgJ2xnJyA9PiAnaGlkZGVuIGxnOnRhYmxlLWNlbGwnLAogICAgICAgICAgICAgICAgJ3hsJyA9PiAnaGlkZGVuIHhsOnRhYmxlLWNlbGwnLAogICAgICAgICAgICAgICAgJzJ4bCcgPT4gJ2hpZGRlbiAyeGw6dGFibGUtY2VsbCcsCiAgICAgICAgICAgIH07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH07CkBlbmRwaHAKCjxkaXYKICAgIHgtZGF0YT0iewogICAgICAgIGhhc0hlYWRlcjogdHJ1ZSwKCiAgICAgICAgaXNMb2FkaW5nOiBmYWxzZSwKCiAgICAgICAgc2VsZWN0ZWRSZWNvcmRzOiBbXSwKCiAgICAgICAgc2hvdWxkQ2hlY2tVbmlxdWVTZWxlY3Rpb246IHRydWUsCgogICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgJHdpcmUub24oJ2Rlc2VsZWN0QWxsVGFibGVSZWNvcmRzJywgKCkgPT4gdGhpcy5kZXNlbGVjdEFsbFJlY29yZHMoKSkKCiAgICAgICAgICAgICR3YXRjaCgnc2VsZWN0ZWRSZWNvcmRzJywgKCkgPT4gewogICAgICAgICAgICAgICAgaWYgKCEgdGhpcy5zaG91bGRDaGVja1VuaXF1ZVNlbGVjdGlvbikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuc2hvdWxkQ2hlY2tVbmlxdWVTZWxlY3Rpb24gPSB0cnVlCgogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSZWNvcmRzID0gWy4uLm5ldyBTZXQodGhpcy5zZWxlY3RlZFJlY29yZHMpXQoKICAgICAgICAgICAgICAgIHRoaXMuc2hvdWxkQ2hlY2tVbmlxdWVTZWxlY3Rpb24gPSBmYWxzZQogICAgICAgICAgICB9KQogICAgICAgIH0sCgogICAgICAgIG1vdW50QnVsa0FjdGlvbjogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICAgICAgJHdpcmUubW91bnRUYWJsZUJ1bGtBY3Rpb24obmFtZSwgdGhpcy5zZWxlY3RlZFJlY29yZHMpCiAgICAgICAgfSwKCiAgICAgICAgdG9nZ2xlU2VsZWN0UmVjb3Jkc09uUGFnZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICBsZXQga2V5cyA9IHRoaXMuZ2V0UmVjb3Jkc09uUGFnZSgpCgogICAgICAgICAgICBpZiAodGhpcy5hcmVSZWNvcmRzU2VsZWN0ZWQoa2V5cykpIHsKICAgICAgICAgICAgICAgIHRoaXMuZGVzZWxlY3RSZWNvcmRzKGtleXMpCgogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuc2VsZWN0UmVjb3JkcyhrZXlzKQogICAgICAgIH0sCgogICAgICAgIGdldFJlY29yZHNPblBhZ2U6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgbGV0IGtleXMgPSBbXQoKICAgICAgICAgICAgZm9yIChjaGVja2JveCBvZiAkZWwuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGFibGUtcm93LWNoZWNrYm94JykpIHsKICAgICAgICAgICAgICAgIGtleXMucHVzaChjaGVja2JveC52YWx1ZSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGtleXMKICAgICAgICB9LAoKICAgICAgICBzZWxlY3RSZWNvcmRzOiBmdW5jdGlvbiAoa2V5cykgewogICAgICAgICAgICBmb3IgKGtleSBvZiBrZXlzKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc1JlY29yZFNlbGVjdGVkKGtleSkpIHsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRSZWNvcmRzLnB1c2goa2V5KQogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZGVzZWxlY3RSZWNvcmRzOiBmdW5jdGlvbiAoa2V5cykgewogICAgICAgICAgICBmb3IgKGtleSBvZiBrZXlzKSB7CiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSB0aGlzLnNlbGVjdGVkUmVjb3Jkcy5pbmRleE9mKGtleSkKCiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUmVjb3Jkcy5zcGxpY2UoaW5kZXgsIDEpCiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBzZWxlY3RBbGxSZWNvcmRzOiBhc3luYyBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZQoKICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJlY29yZHMgPSAoYXdhaXQgJHdpcmUuZ2V0QWxsVGFibGVSZWNvcmRLZXlzKCkpLm1hcCgoa2V5KSA9PiBrZXkudG9TdHJpbmcoKSkKCiAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2UKICAgICAgICB9LAoKICAgICAgICBkZXNlbGVjdEFsbFJlY29yZHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFJlY29yZHMgPSBbXQogICAgICAgIH0sCgogICAgICAgIGlzUmVjb3JkU2VsZWN0ZWQ6IGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWRSZWNvcmRzLmluY2x1ZGVzKGtleSkKICAgICAgICB9LAoKICAgICAgICBhcmVSZWNvcmRzU2VsZWN0ZWQ6IGZ1bmN0aW9uIChrZXlzKSB7CiAgICAgICAgICAgIHJldHVybiBrZXlzLmV2ZXJ5KGtleSA9PiB0aGlzLmlzUmVjb3JkU2VsZWN0ZWQoa2V5KSkKICAgICAgICB9LAoKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vbGFyYXZlbC9mcmFtZXdvcmsvYmxvYi81Mjk5YzIyMzIxYzBmMWVhOGZmNzcwYjg0YTZjNjQ2OWM0ZDZlZGVjL3NyYy9JbGx1bWluYXRlL1RyYW5zbGF0aW9uL01lc3NhZ2VTZWxlY3Rvci5waHAjTDE1CiAgICAgICAgcGx1cmFsaXplOiBmdW5jdGlvbiAodGV4dCwgbnVtYmVyLCB2YXJpYWJsZXMpIHsKICAgICAgICAgICAgZnVuY3Rpb24gZXh0cmFjdChzZWdtZW50cywgbnVtYmVyKSB7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhcnQgb2Ygc2VnbWVudHMpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lID0gZXh0cmFjdEZyb21TdHJpbmcocGFydCwgbnVtYmVyKQoKICAgICAgICAgICAgICAgICAgICBpZiAobGluZSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gZXh0cmFjdEZyb21TdHJpbmcocGFydCwgbnVtYmVyKSB7CiAgICAgICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gcGFydC5tYXRjaCgvXltce1xbXShbXlxbXF1ce1x9XSopW1x9XF1dKC4qKS9zKQoKICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzID09PSBudWxsIHx8IG1hdGNoZXMubGVuZ3RoICE9PSAzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGwKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCBjb25kaXRpb24gPSBtYXRjaGVzWzFdCgogICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBtYXRjaGVzWzJdCgogICAgICAgICAgICAgICAgaWYgKGNvbmRpdGlvbi5pbmNsdWRlcygnLCcpKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgW2Zyb20sIHRvXSA9IGNvbmRpdGlvbi5zcGxpdCgnLCcsIDIpCgogICAgICAgICAgICAgICAgICAgIGlmICh0byA9PT0gJyonICYmIG51bWJlciA+PSBmcm9tKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZnJvbSA9PT0gJyonICYmIG51bWJlciA8PSB0bykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG51bWJlciA+PSBmcm9tICYmIG51bWJlciA8PSB0bykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIGNvbmRpdGlvbiA9PSBudW1iZXIgPyB2YWx1ZSA6IG51bGwKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gdWNmaXJzdChzdHJpbmcpIHsKICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcudG9TdHJpbmcoKS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0cmluZy50b1N0cmluZygpLnNsaWNlKDEpCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIHJlcGxhY2UobGluZSwgcmVwbGFjZSkgewogICAgICAgICAgICAgICAgaWYgKHJlcGxhY2UubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmUKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb25zdCBzaG91bGRSZXBsYWNlID0ge30KCiAgICAgICAgICAgICAgICBmb3IgKGxldCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMocmVwbGFjZSkpIHsKICAgICAgICAgICAgICAgICAgICBzaG91bGRSZXBsYWNlWyc6JyArIHVjZmlyc3Qoa2V5ID8/ICcnKV0gPSB1Y2ZpcnN0KHZhbHVlID8/ICcnKQogICAgICAgICAgICAgICAgICAgIHNob3VsZFJlcGxhY2VbJzonICsga2V5LnRvVXBwZXJDYXNlKCldID0gdmFsdWUudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpCiAgICAgICAgICAgICAgICAgICAgc2hvdWxkUmVwbGFjZVsnOicgKyBrZXldID0gdmFsdWUKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyhzaG91bGRSZXBsYWNlKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHsKICAgICAgICAgICAgICAgICAgICBsaW5lID0gbGluZS5yZXBsYWNlQWxsKGtleSwgdmFsdWUpCiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgIHJldHVybiBsaW5lCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIHN0cmlwQ29uZGl0aW9ucyhzZWdtZW50cykgewogICAgICAgICAgICAgICAgcmV0dXJuIHNlZ21lbnRzLm1hcChwYXJ0ID0+IHBhcnQucmVwbGFjZSgvXltce1xbXShbXlxbXF1ce1x9XSopW1x9XF1dLywgJycpKQogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgc2VnbWVudHMgPSB0ZXh0LnNwbGl0KCd8JykKCiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gZXh0cmFjdChzZWdtZW50cywgbnVtYmVyKQoKICAgICAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXBsYWNlKHZhbHVlLnRyaW0oKSwgdmFyaWFibGVzKQogICAgICAgICAgICB9CgogICAgICAgICAgICBzZWdtZW50cyA9IHN0cmlwQ29uZGl0aW9ucyhzZWdtZW50cykKCiAgICAgICAgICAgIHJldHVybiByZXBsYWNlKHNlZ21lbnRzLmxlbmd0aCA+IDEgJiYgbnVtYmVyID4gMSA/IHNlZ21lbnRzWzFdIDogc2VnbWVudHNbMF0sIHZhcmlhYmxlcykKICAgICAgICB9CiAgICB9IgogICAgY2xhc3M9ImZpbGFtZW50LXRhYmxlcy1jb21wb25lbnQiCj4KICAgIDx4LXRhYmxlczo6Y29udGFpbmVyPgogICAgICAgIDxkaXYKICAgICAgICAgICAgeC1zaG93PSJoYXNIZWFkZXIgPSAoe3sgKCRyZW5kZXJIZWFkZXIgPSAoJGhlYWRlciB8fCAkaGVhZGluZyB8fCAkaGVhZGVyQWN0aW9ucyB8fCAkaXNTZWFyY2hWaXNpYmxlIHx8ICRoYXNGaWx0ZXJzIHx8ICRpc0NvbHVtblRvZ2dsZUZvcm1WaXNpYmxlKSkgPyAndHJ1ZScgOiAnZmFsc2UnIH19IHx8IHNlbGVjdGVkUmVjb3Jkcy5sZW5ndGgpIgogICAgICAgICAgICB7ISEgISAkcmVuZGVySGVhZGVyID8gJ3gtY2xvYWsnIDogbnVsbCAhIX0KICAgICAgICA+CiAgICAgICAgICAgIEBpZiAoJGhlYWRlcikKICAgICAgICAgICAgICAgIHt7ICRoZWFkZXIgfX0KICAgICAgICAgICAgQGVsc2VpZiAoJGhlYWRpbmcgfHwgJGhlYWRlckFjdGlvbnMpCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJweC0yIHB0LTIiPgogICAgICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6aGVhZGVyIDphY3Rpb25zPSIkaGVhZGVyQWN0aW9ucyIgY2xhc3M9Im1iLTIiPgogICAgICAgICAgICAgICAgICAgICAgICA8eC1zbG90IG5hbWU9ImhlYWRpbmciPgogICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgJGhlYWRpbmcgfX0KICAgICAgICAgICAgICAgICAgICAgICAgPC94LXNsb3Q+CgogICAgICAgICAgICAgICAgICAgICAgICA8eC1zbG90IG5hbWU9ImRlc2NyaXB0aW9uIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7ICRnZXREZXNjcmlwdGlvbigpIH19CiAgICAgICAgICAgICAgICAgICAgICAgIDwveC1zbG90PgogICAgICAgICAgICAgICAgICAgIDwveC10YWJsZXM6OmhlYWRlcj4KCiAgICAgICAgICAgICAgICAgICAgPHgtdGFibGVzOjpociB4LXNob3c9Int7ICgkaXNTZWFyY2hWaXNpYmxlIHx8ICRoYXNGaWx0ZXJzIHx8ICRpc0NvbHVtblRvZ2dsZUZvcm1WaXNpYmxlKSA/ICd0cnVlJyA6ICdmYWxzZScgfX0gfHwgc2VsZWN0ZWRSZWNvcmRzLmxlbmd0aCIgLz4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICBAZW5kaWYKCiAgICAgICAgICAgIEBpZiAoJGhhc0ZpbHRlcnNBYm92ZUNvbnRlbnQpCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJweC0yIHB0LTIiPgogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InAtNCBtYi0yIj4KICAgICAgICAgICAgICAgICAgICAgICAgPHgtdGFibGVzOjpmaWx0ZXJzIDpmb3JtPSIkZ2V0RmlsdGVyc0Zvcm0oKSIgLz4KICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KCiAgICAgICAgICAgICAgICAgICAgPHgtdGFibGVzOjpociB4LXNob3c9Int7ICgkaXNTZWFyY2hWaXNpYmxlIHx8ICRpc0NvbHVtblRvZ2dsZUZvcm1WaXNpYmxlKSA/ICd0cnVlJyA6ICdmYWxzZScgfX0gfHwgc2VsZWN0ZWRSZWNvcmRzLmxlbmd0aCIgLz4KICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICBAZW5kaWYKCiAgICAgICAgICAgIDxkaXYKICAgICAgICAgICAgICAgIHgtc2hvdz0ie3sgKCRzaG91bGRSZW5kZXJIZWFkZXJEaXYgPSAoJGlzU2VhcmNoVmlzaWJsZSB8fCAkaGFzRmlsdGVyc1BvcG92ZXIgfHwgJGlzQ29sdW1uVG9nZ2xlRm9ybVZpc2libGUpKSA/ICd0cnVlJyA6ICdmYWxzZScgfX0gfHwgc2VsZWN0ZWRSZWNvcmRzLmxlbmd0aCIKICAgICAgICAgICAgICAgIHshISAhICRzaG91bGRSZW5kZXJIZWFkZXJEaXYgPyAneC1jbG9haycgOiBudWxsICEhfQogICAgICAgICAgICAgICAgY2xhc3M9ImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktYmV0d2VlbiBwLTIgaC0xNCIKICAgICAgICAgICAgPgogICAgICAgICAgICAgICAgPGRpdj4KICAgICAgICAgICAgICAgICAgICA8eC10YWJsZXM6OmJ1bGstYWN0aW9ucwogICAgICAgICAgICAgICAgICAgICAgICB4LXNob3c9InNlbGVjdGVkUmVjb3Jkcy5sZW5ndGgiCiAgICAgICAgICAgICAgICAgICAgICAgIDphY3Rpb25zPSIkZ2V0QnVsa0FjdGlvbnMoKSIKICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9Im1kOm1yLTIiCiAgICAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgIDwvZGl2PgoKICAgICAgICAgICAgICAgIEBpZiAoJGlzU2VhcmNoVmlzaWJsZSB8fCAkaGFzRmlsdGVyc1BvcG92ZXIgfHwgJGlzQ29sdW1uVG9nZ2xlRm9ybVZpc2libGUpCiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idy1mdWxsIGZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktZW5kIGdhcC0yIG1kOm1heC13LW1kIj4KICAgICAgICAgICAgICAgICAgICAgICAgQGlmICgkaXNTZWFyY2hWaXNpYmxlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0iZmxleC0xIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8eC10YWJsZXM6OnNlYXJjaC1pbnB1dC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgQGVuZGlmCgogICAgICAgICAgICAgICAgICAgICAgICBAaWYgKCRpc0NvbHVtblRvZ2dsZUZvcm1WaXNpYmxlKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHgtdGFibGVzOjp0b2dnbGVhYmxlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmZvcm09IiRnZXRDb2x1bW5Ub2dnbGVGb3JtKCkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOndpZHRoPSIkZ2V0Q29sdW1uVG9nZ2xlRm9ybVdpZHRoKCkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9InNocmluay0wIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgICAgICAgICAgQGVuZGlmCgogICAgICAgICAgICAgICAgICAgICAgICBAaWYgKCRoYXNGaWx0ZXJzUG9wb3ZlcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6ZmlsdGVycy5wb3BvdmVyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmZvcm09IiRnZXRGaWx0ZXJzRm9ybSgpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDp3aWR0aD0iJGdldEZpbHRlcnNGb3JtV2lkdGgoKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzcz0ic2hyaW5rLTAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPgogICAgICAgICAgICAgICAgICAgICAgICBAZW5kaWYKICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgIEBlbmRpZgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPGRpdgogICAgICAgICAgICBAY2xhc3MoWwogICAgICAgICAgICAgICAgJ292ZXJmbG93LXktYXV0byByZWxhdGl2ZScsCiAgICAgICAgICAgICAgICAnZGFyazpib3JkZXItZ3JheS03MDAnID0+IGNvbmZpZygndGFibGVzLmRhcmtfbW9kZScpLAogICAgICAgICAgICAgICAgJ3JvdW5kZWQtdC14bCcgPT4gISAkcmVuZGVySGVhZGVyLAogICAgICAgICAgICAgICAgJ2JvcmRlci10JyA9PiAkcmVuZGVySGVhZGVyLAogICAgICAgICAgICBdKQogICAgICAgICAgICB4LWJpbmQ6Y2xhc3M9InsKICAgICAgICAgICAgICAgICdyb3VuZGVkLXQteGwnOiAhIGhhc0hlYWRlciwKICAgICAgICAgICAgICAgICdib3JkZXItdCc6IGhhc0hlYWRlciwKICAgICAgICAgICAgfSIKICAgICAgICA+CiAgICAgICAgICAgIEBpZiAoKCRyZWNvcmRzID0gJGdldFJlY29yZHMoKSktPmNvdW50KCkpCiAgICAgICAgICAgICAgICBAaWYgKCRjb250ZW50KQogICAgICAgICAgICAgICAgICAgIHt7ICRjb250ZW50LT53aXRoKFsncmVjb3JkcycgPT4gJHJlY29yZHNdKSB9fQogICAgICAgICAgICAgICAgQGVsc2UKICAgICAgICAgICAgICAgICAgICA8eC10YWJsZXM6OnRhYmxlPgogICAgICAgICAgICAgICAgICAgICAgICA8eC1zbG90IG5hbWU9ImhlYWRlciI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAaWYgKCRpc1NlbGVjdGlvbkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8eC10YWJsZXM6OmNoZWNrYm94LWNlbGw+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx4LXNsb3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU9ImNoZWNrYm94IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgeC1vbjpjbGljaz0idG9nZ2xlU2VsZWN0UmVjb3Jkc09uUGFnZSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHgtYmluZDpjaGVja2VkPSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJlUmVjb3Jkc1NlbGVjdGVkKGdldFJlY29yZHNPblBhZ2UoKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGVsLmNoZWNrZWQgPSB0cnVlCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2NoZWNrZWQnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZWwuY2hlY2tlZCA9IGZhbHNlCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID48L3gtc2xvdD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3gtdGFibGVzOjpjaGVja2JveC1jZWxsPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGVuZGlmCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGZvcmVhY2ggKCRjb2x1bW5zIGFzICRjb2x1bW4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHgtdGFibGVzOjpoZWFkZXItY2VsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ZXh0cmEtYXR0cmlidXRlcz0iJGNvbHVtbi0+Z2V0RXh0cmFIZWFkZXJBdHRyaWJ1dGVzKCkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDppcy1zb3J0LWNvbHVtbj0iJGdldFNvcnRDb2x1bW4oKSA9PT0gJGNvbHVtbi0+Z2V0TmFtZSgpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6bmFtZT0iJGNvbHVtbi0+Z2V0TmFtZSgpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6YWxpZ25tZW50PSIkY29sdW1uLT5nZXRBbGlnbm1lbnQoKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnNvcnRhYmxlPSIkY29sdW1uLT5pc1NvcnRhYmxlKCkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpzb3J0LWRpcmVjdGlvbj0iJGdldFNvcnREaXJlY3Rpb24oKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmNsYXNzPSIkZ2V0SGlkZGVuQ2xhc3NlcygkY29sdW1uKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7ICRjb2x1bW4tPmdldExhYmVsKCkgfX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3gtdGFibGVzOjpoZWFkZXItY2VsbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBlbmRmb3JlYWNoCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGlmIChjb3VudCgkYWN0aW9ucykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHRoIGNsYXNzPSJ3LTUiPjwvdGg+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBAZW5kaWYKICAgICAgICAgICAgICAgICAgICAgICAgPC94LXNsb3Q+CgogICAgICAgICAgICAgICAgICAgICAgICBAaWYgKCRpc1NlbGVjdGlvbkVuYWJsZWQoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6c2VsZWN0aW9uLWluZGljYXRvcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDphbGwtcmVjb3Jkcy1jb3VudD0iJGdldEFsbFJlY29yZHNDb3VudCgpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpjb2xzcGFuPSIkY29sdW1uc0NvdW50IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHgtc2hvdz0ic2VsZWN0ZWRSZWNvcmRzLmxlbmd0aCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8eC1zbG90IG5hbWU9InNlbGVjdGVkUmVjb3Jkc0NvdW50Ij4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4geC10ZXh0PSJzZWxlY3RlZFJlY29yZHMubGVuZ3RoIj48L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC94LXNsb3Q+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3gtdGFibGVzOjpzZWxlY3Rpb24taW5kaWNhdG9yPgogICAgICAgICAgICAgICAgICAgICAgICBAZW5kaWYKCiAgICAgICAgICAgICAgICAgICAgICAgIEBmb3JlYWNoICgkcmVjb3JkcyBhcyAkcmVjb3JkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQHBocAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZWNvcmRVcmwgPSAkZ2V0UmVjb3JkVXJsKCRyZWNvcmQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGVuZHBocAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6cm93CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnJlY29yZC11cmw9IiRyZWNvcmRVcmwiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lyZTprZXk9Int7ICR0aGlzLT5nZXRUYWJsZVJlY29yZEtleSgkcmVjb3JkKSB9fSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4LWJpbmQ6Y2xhc3M9InsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2JnLWdyYXktNTAge3sgY29uZmlnKCd0YWJsZXMuZGFya19tb2RlJykgPyAnZGFyazpiZy1ncmF5LTUwMC8xMCcgOiAnJyB9fSc6IGlzUmVjb3JkU2VsZWN0ZWQoJ3t7ICR0aGlzLT5nZXRUYWJsZVJlY29yZEtleSgkcmVjb3JkKSB9fScpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0iCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQGlmICgkaXNTZWxlY3Rpb25FbmFibGVkKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6Y2hlY2tib3gtY2VsbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx4LXNsb3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lPSJjaGVja2JveCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB4LW1vZGVsPSJzZWxlY3RlZFJlY29yZHMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnZhbHVlPSIkdGhpcy0+Z2V0VGFibGVSZWNvcmRLZXkoJHJlY29yZCkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9InRhYmxlLXJvdy1jaGVja2JveCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID48L3gtc2xvdD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC94LXRhYmxlczo6Y2hlY2tib3gtY2VsbD4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAZW5kaWYKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQGZvcmVhY2ggKCRjb2x1bW5zIGFzICRjb2x1bW4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBwaHAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb2x1bW4tPnJlY29yZCgkcmVjb3JkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQGVuZHBocAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHgtdGFibGVzOjpjZWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6YWN0aW9uPSIkY29sdW1uLT5nZXRBY3Rpb24oKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpuYW1lPSIkY29sdW1uLT5nZXROYW1lKCkiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6YWxpZ25tZW50PSIkY29sdW1uLT5nZXRBbGlnbm1lbnQoKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpyZWNvcmQ9IiRyZWNvcmQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6dG9vbHRpcD0iJGNvbHVtbi0+Z2V0VG9vbHRpcCgpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnJlY29yZC1hY3Rpb249IiRnZXRSZWNvcmRBY3Rpb24oKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDpyZWNvcmQtdXJsPSIkcmVjb3JkVXJsIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnNob3VsZC1vcGVuLXVybC1pbi1uZXctdGFiPSIkY29sdW1uLT5zaG91bGRPcGVuVXJsSW5OZXdUYWIoKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDp1cmw9IiRjb2x1bW4tPmdldFVybCgpIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmNsYXNzPSIkZ2V0SGlkZGVuQ2xhc3NlcygkY29sdW1uKSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpcmU6bG9hZGluZy5yZW1vdmUuZGVsYXkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpcmU6dGFyZ2V0PSJ7eyBpbXBsb2RlKCcsJywgXEZpbGFtZW50XFRhYmxlc1xUYWJsZTo6TE9BRElOR19UQVJHRVRTKSB9fSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgJGNvbHVtbiB9fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3gtdGFibGVzOjpjZWxsPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBlbmRmb3JlYWNoCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBpZiAoY291bnQoJGFjdGlvbnMpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8eC10YWJsZXM6OmFjdGlvbnMtY2VsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmFjdGlvbnM9IiRhY3Rpb25zIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnJlY29yZD0iJHJlY29yZCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpcmU6bG9hZGluZy5yZW1vdmUuZGVsYXkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpcmU6dGFyZ2V0PSJ7eyBpbXBsb2RlKCcsJywgXEZpbGFtZW50XFRhYmxlc1xUYWJsZTo6TE9BRElOR19UQVJHRVRTKSB9fSIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBAZW5kaWYKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHgtdGFibGVzOjpsb2FkaW5nLWNlbGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOmNvbHNwYW49IiRjb2x1bW5zQ291bnQiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpcmU6bG9hZGluZy5jbGFzcy5yZW1vdmUuZGVsYXk9ImhpZGRlbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M9ImhpZGRlbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lyZTp0YXJnZXQ9Int7IGltcGxvZGUoJywnLCBcRmlsYW1lbnRcVGFibGVzXFRhYmxlOjpMT0FESU5HX1RBUkdFVFMpIH19IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3gtdGFibGVzOjpyb3c+CiAgICAgICAgICAgICAgICAgICAgICAgIEBlbmRmb3JlYWNoCgogICAgICAgICAgICAgICAgICAgICAgICBAaWYgKCRjb250ZW50Rm9vdGVyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHgtc2xvdCBuYW1lPSJmb290ZXIiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7ICRjb250ZW50Rm9vdGVyLT53aXRoKFsnY29sdW1ucycgPT4gJGNvbHVtbnMsICdyZWNvcmRzJyA9PiAkcmVjb3Jkc10pIH19CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3gtc2xvdD4KICAgICAgICAgICAgICAgICAgICAgICAgQGVuZGlmCiAgICAgICAgICAgICAgICAgICAgPC94LXRhYmxlczo6dGFibGU+CiAgICAgICAgICAgICAgICBAZW5kaWYKICAgICAgICAgICAgQGVsc2UKICAgICAgICAgICAgICAgIEBpZiAoJGVtcHR5U3RhdGUgPSAkZ2V0RW1wdHlTdGF0ZSgpKQogICAgICAgICAgICAgICAgICAgIHt7ICRlbXB0eVN0YXRlIH19CiAgICAgICAgICAgICAgICBAZWxzZQogICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsZXggaXRlbXMtY2VudGVyIGp1c3RpZnktY2VudGVyIHAtNCI+CiAgICAgICAgICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6ZW1wdHktc3RhdGUgOmljb249IiRnZXRFbXB0eVN0YXRlSWNvbigpIiA6YWN0aW9ucz0iJGdldEVtcHR5U3RhdGVBY3Rpb25zKCkiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHgtc2xvdCBuYW1lPSJoZWFkaW5nIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyAkZ2V0RW1wdHlTdGF0ZUhlYWRpbmcoKSB9fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPC94LXNsb3Q+CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPHgtc2xvdCBuYW1lPSJkZXNjcmlwdGlvbiI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgJGdldEVtcHR5U3RhdGVEZXNjcmlwdGlvbigpIH19CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3gtc2xvdD4KICAgICAgICAgICAgICAgICAgICAgICAgPC94LXRhYmxlczo6ZW1wdHktc3RhdGU+CiAgICAgICAgICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgICAgICBAZW5kaWYKICAgICAgICAgICAgQGVuZGlmCiAgICAgICAgPC9kaXY+CgogICAgICAgIEBpZiAoJGlzUGFnaW5hdGlvbkVuYWJsZWQoKSkKICAgICAgICAgICAgPGRpdiBAY2xhc3MoWwogICAgICAgICAgICAgICAgJ3AtMiBib3JkZXItdCcsCiAgICAgICAgICAgICAgICAnZGFyazpib3JkZXItZ3JheS03MDAnID0+IGNvbmZpZygndGFibGVzLmRhcmtfbW9kZScpLAogICAgICAgICAgICBdKT4KICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6cGFnaW5hdGlvbgogICAgICAgICAgICAgICAgICAgIDpwYWdpbmF0b3I9IiRyZWNvcmRzIgogICAgICAgICAgICAgICAgICAgIDpyZWNvcmRzLXBlci1wYWdlLXNlbGVjdC1vcHRpb25zPSIkZ2V0UmVjb3Jkc1BlclBhZ2VTZWxlY3RPcHRpb25zKCkiCiAgICAgICAgICAgICAgICAvPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICBAZW5kaWYKICAgIDwveC10YWJsZXM6OmNvbnRhaW5lcj4KCiAgICA8Zm9ybSB3aXJlOnN1Ym1pdC5wcmV2ZW50PSJjYWxsTW91bnRlZFRhYmxlQWN0aW9uIj4KICAgICAgICBAcGhwCiAgICAgICAgICAgICRhY3Rpb24gPSAkZ2V0TW91bnRlZEFjdGlvbigpOwogICAgICAgIEBlbmRwaHAKCiAgICAgICAgPHgtdGFibGVzOjptb2RhbCA6aWQ9IlxJbGx1bWluYXRlXFN1cHBvcnRcU3RyOjpvZihzdGF0aWM6OmNsYXNzKS0+cmVwbGFjZSgnXFwnLCAnXFxcXCcpIC4gJy10YWJsZS1hY3Rpb24nIiA6dmlzaWJsZT0iZmlsbGVkKCRhY3Rpb24pIiA6d2lkdGg9IiRhY3Rpb24/LT5nZXRNb2RhbFdpZHRoKCkiIGRpc3BsYXktY2xhc3Nlcz0iYmxvY2siPgogICAgICAgICAgICBAaWYgKCRhY3Rpb24pCiAgICAgICAgICAgICAgICBAaWYgKCRhY3Rpb24tPmlzTW9kYWxDZW50ZXJlZCgpKQogICAgICAgICAgICAgICAgICAgIDx4LXNsb3QgbmFtZT0iaGVhZGluZyI+CiAgICAgICAgICAgICAgICAgICAgICAgIHt7ICRhY3Rpb24tPmdldE1vZGFsSGVhZGluZygpIH19CiAgICAgICAgICAgICAgICAgICAgPC94LXNsb3Q+CgogICAgICAgICAgICAgICAgICAgIEBpZiAoJHN1YmhlYWRpbmcgPSAkYWN0aW9uLT5nZXRNb2RhbFN1YmhlYWRpbmcoKSkKICAgICAgICAgICAgICAgICAgICAgICAgPHgtc2xvdCBuYW1lPSJzdWJoZWFkaW5nIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7ICRzdWJoZWFkaW5nIH19CiAgICAgICAgICAgICAgICAgICAgICAgIDwveC1zbG90PgogICAgICAgICAgICAgICAgICAgIEBlbmRpZgogICAgICAgICAgICAgICAgQGVsc2UKICAgICAgICAgICAgICAgICAgICA8eC1zbG90IG5hbWU9ImhlYWRlciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6bW9kYWwuaGVhZGluZz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHt7ICRhY3Rpb24tPmdldE1vZGFsSGVhZGluZygpIH19CiAgICAgICAgICAgICAgICAgICAgICAgIDwveC10YWJsZXM6Om1vZGFsLmhlYWRpbmc+CiAgICAgICAgICAgICAgICAgICAgPC94LXNsb3Q+CiAgICAgICAgICAgICAgICBAZW5kaWYKCiAgICAgICAgICAgICAgICB7eyAkYWN0aW9uLT5nZXRNb2RhbENvbnRlbnQoKSB9fQoKICAgICAgICAgICAgICAgIEBpZiAoJGFjdGlvbi0+aGFzRm9ybVNjaGVtYSgpKQogICAgICAgICAgICAgICAgICAgIHt7ICRnZXRNb3VudGVkQWN0aW9uRm9ybSgpIH19CiAgICAgICAgICAgICAgICBAZW5kaWYKCiAgICAgICAgICAgICAgICBAaWYgKGNvdW50KCRhY3Rpb24tPmdldE1vZGFsQWN0aW9ucygpKSkKICAgICAgICAgICAgICAgICAgICA8eC1zbG90IG5hbWU9ImZvb3RlciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6bW9kYWwuYWN0aW9ucyA6ZnVsbC13aWR0aD0iJGFjdGlvbi0+aXNNb2RhbENlbnRlcmVkKCkiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGZvcmVhY2ggKCRhY3Rpb24tPmdldE1vZGFsQWN0aW9ucygpIGFzICRtb2RhbEFjdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyAkbW9kYWxBY3Rpb24gfX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBlbmRmb3JlYWNoCiAgICAgICAgICAgICAgICAgICAgICAgIDwveC10YWJsZXM6Om1vZGFsLmFjdGlvbnM+CiAgICAgICAgICAgICAgICAgICAgPC94LXNsb3Q+CiAgICAgICAgICAgICAgICBAZW5kaWYKICAgICAgICAgICAgQGVuZGlmCiAgICAgICAgPC94LXRhYmxlczo6bW9kYWw+CiAgICA8L2Zvcm0+CgogICAgPGZvcm0gd2lyZTpzdWJtaXQucHJldmVudD0iY2FsbE1vdW50ZWRUYWJsZUJ1bGtBY3Rpb24iPgogICAgICAgIEBwaHAKICAgICAgICAgICAgJGFjdGlvbiA9ICRnZXRNb3VudGVkQnVsa0FjdGlvbigpOwogICAgICAgIEBlbmRwaHAKCiAgICAgICAgPHgtdGFibGVzOjptb2RhbCA6aWQ9IlxJbGx1bWluYXRlXFN1cHBvcnRcU3RyOjpvZihzdGF0aWM6OmNsYXNzKS0+cmVwbGFjZSgnXFwnLCAnXFxcXCcpIC4gJy10YWJsZS1idWxrLWFjdGlvbiciIDp2aXNpYmxlPSJmaWxsZWQoJGFjdGlvbikiIDp3aWR0aD0iJGFjdGlvbj8tPmdldE1vZGFsV2lkdGgoKSIgZGlzcGxheS1jbGFzc2VzPSJibG9jayI+CiAgICAgICAgICAgIEBpZiAoJGFjdGlvbikKICAgICAgICAgICAgICAgIEBpZiAoJGFjdGlvbi0+aXNNb2RhbENlbnRlcmVkKCkpCiAgICAgICAgICAgICAgICAgICAgPHgtc2xvdCBuYW1lPSJoZWFkaW5nIj4KICAgICAgICAgICAgICAgICAgICAgICAge3sgJGFjdGlvbi0+Z2V0TW9kYWxIZWFkaW5nKCkgfX0KICAgICAgICAgICAgICAgICAgICA8L3gtc2xvdD4KCiAgICAgICAgICAgICAgICAgICAgQGlmICgkc3ViaGVhZGluZyA9ICRhY3Rpb24tPmdldE1vZGFsU3ViaGVhZGluZygpKQogICAgICAgICAgICAgICAgICAgICAgICA8eC1zbG90IG5hbWU9InN1YmhlYWRpbmciPgogICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgJHN1YmhlYWRpbmcgfX0KICAgICAgICAgICAgICAgICAgICAgICAgPC94LXNsb3Q+CiAgICAgICAgICAgICAgICAgICAgQGVuZGlmCiAgICAgICAgICAgICAgICBAZWxzZQogICAgICAgICAgICAgICAgICAgIDx4LXNsb3QgbmFtZT0iaGVhZGVyIj4KICAgICAgICAgICAgICAgICAgICAgICAgPHgtdGFibGVzOjptb2RhbC5oZWFkaW5nPgogICAgICAgICAgICAgICAgICAgICAgICAgICAge3sgJGFjdGlvbi0+Z2V0TW9kYWxIZWFkaW5nKCkgfX0KICAgICAgICAgICAgICAgICAgICAgICAgPC94LXRhYmxlczo6bW9kYWwuaGVhZGluZz4KICAgICAgICAgICAgICAgICAgICA8L3gtc2xvdD4KICAgICAgICAgICAgICAgIEBlbmRpZgoKICAgICAgICAgICAgICAgIHt7ICRhY3Rpb24tPmdldE1vZGFsQ29udGVudCgpIH19CgogICAgICAgICAgICAgICAgQGlmICgkYWN0aW9uLT5oYXNGb3JtU2NoZW1hKCkpCiAgICAgICAgICAgICAgICAgICAge3sgJGdldE1vdW50ZWRCdWxrQWN0aW9uRm9ybSgpIH19CiAgICAgICAgICAgICAgICBAZW5kaWYKCiAgICAgICAgICAgICAgICBAaWYgKGNvdW50KCRhY3Rpb24tPmdldE1vZGFsQWN0aW9ucygpKSkKICAgICAgICAgICAgICAgICAgICA8eC1zbG90IG5hbWU9ImZvb3RlciI+CiAgICAgICAgICAgICAgICAgICAgICAgIDx4LXRhYmxlczo6bW9kYWwuYWN0aW9ucyA6ZnVsbC13aWR0aD0iJGFjdGlvbi0+aXNNb2RhbENlbnRlcmVkKCkiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgQGZvcmVhY2ggKCRhY3Rpb24tPmdldE1vZGFsQWN0aW9ucygpIGFzICRtb2RhbEFjdGlvbikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7eyAkbW9kYWxBY3Rpb24gfX0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEBlbmRmb3JlYWNoCiAgICAgICAgICAgICAgICAgICAgICAgIDwveC10YWJsZXM6Om1vZGFsLmFjdGlvbnM+CiAgICAgICAgICAgICAgICAgICAgPC94LXNsb3Q+CiAgICAgICAgICAgICAgICBAZW5kaWYKICAgICAgICAgICAgQGVuZGlmCiAgICAgICAgPC94LXRhYmxlczo6bW9kYWw+CiAgICA8L2Zvcm0+CgogICAgQGlmICghICR0aGlzIGluc3RhbmNlb2YgXEZpbGFtZW50XFRhYmxlc1xDb250cmFjdHNcUmVuZGVyc0Zvcm1Db21wb25lbnRBY3Rpb25Nb2RhbCkKICAgICAgICB7eyAkdGhpcy0+bW9kYWwgfX0KICAgIEBlbmRpZgo8L2Rpdj4KIjtzOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG5hbWVzcGFjZXMiO2E6MDp7fXM6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAaW5jbHVkZXMiO2E6MDp7fXM6NDQ6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAZnVuY3Rpb25zIjthOjA6e31zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGNvbnN0YW50cyI7YTowOnt9czo0MjoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBjbGFzc2VzIjthOjA6e31zOjQ1OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGludGVyZmFjZXMiO2E6MDp7fXM6NDE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAdHJhaXRzIjthOjA6e31zOjQwOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGVudW1zIjthOjA6e31zOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAG1ldGFkYXRhIjthOjA6e319";